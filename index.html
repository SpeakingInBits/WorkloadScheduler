<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instructor Workload Scheduler</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Instructor Workload Scheduler <span id="helpIcon" class="help-icon" onclick="Modals.showHelp()" title="Help">?</span></h1>
            <div class="schedule-controls">
                <select id="scheduleSelect" onchange="ScheduleManager.switchTo()"></select>
                <select id="scheduleQuarter" onchange="ScheduleManager.updateQuarter()">
                    <option value="">Select Quarter</option>
                    <option value="Fall">Fall</option>
                    <option value="Winter">Winter</option>
                    <option value="Spring">Spring</option>
                    <option value="Summer">Summer</option>
                </select>
                <button id="newScheduleBtn" onclick="ScheduleManager.create()">New Schedule</button>
                <button id="renameScheduleBtn" onclick="ScheduleManager.rename()">Rename</button>
                <button id="deleteScheduleBtn" onclick="ScheduleManager.deleteCurrent()">Delete</button>
            </div>
            <div class="data-controls">
                <button id="exportBtn">Export Schedule</button>
                <button id="importBtn">Import Schedule</button>
                <input type="file" id="fileInput" accept=".json" style="display: none;">
            </div>
        </header>

        <div class="main-content">
            <!-- Left Sidebar -->
            <aside class="sidebar">
                <!-- Programs Section -->
                <section class="panel">
                    <h2 class="collapsible-header" onclick="UIState.toggleSection('programs')">
                        <span class="collapse-icon" id="programs-icon">‚ñº</span> Programs
                    </h2>
                    <div id="programs-section" class="collapsible-section">
                        <form id="addProgramForm">
                            <input type="text" id="programName" placeholder="Program name (e.g. CPW)" required>
                            <button type="submit">Add Program</button>
                        </form>
                        <div id="programsList"></div>
                    </div>
                </section>

                <!-- Instructors Section -->
                <section class="panel">
                    <h2 class="collapsible-header" onclick="UIState.toggleSection('instructors')">
                        <span class="collapse-icon" id="instructors-icon">‚ñº</span> Instructors
                    </h2>
                    <div id="instructors-section" class="collapsible-section">
                        <form id="addInstructorForm">
                            <input type="text" id="instructorName" placeholder="Instructor name" required>
                            <button type="submit">Add Instructor</button>
                        </form>
                        <div class="instructor-filter">
                            <label style="font-size: 14px; font-weight: 600; margin-bottom: 5px; display: block;">Filter Instructors:</label>
                            <div class="filter-dropdown">
                                <button type="button" class="filter-toggle" onclick="UIState.toggleInstructorFilter(event)">Select Instructors ‚ñº</button>
                                <div id="instructorFilterList" class="filter-list" style="display: none;"></div>
                            </div>
                        </div>
                        <div id="instructorsList"></div>
                    </div>
                </section>

                <!-- Courses Section (Global Catalog) -->
                <section class="panel">
                    <h2 class="collapsible-header" onclick="UIState.toggleSection('courses')">
                        <span class="collapse-icon" id="courses-icon">‚ñº</span> Courses (Catalog)
                    </h2>
                    <div id="courses-section" class="collapsible-section">
                        <form id="addCourseForm">
                            <select id="courseProgram">
                                <option value="">Select Program</option>
                            </select>
                            <input type="text" id="courseNumber" placeholder="Course number (e.g. 101)">
                            <input type="text" id="courseName" placeholder="Course name (optional)">
                            <input type="number" id="courseCredits" placeholder="Credits" min="1" required>
                            <input type="text" id="courseQuarterTaken" placeholder="Cohort (e.g. Q1, Q2)">
                            <div class="quarters-offered-dropdown">
                                <button type="button" class="filter-toggle" onclick="UIState.toggleQuartersOffered(event, 'add')">Quarters Offered ‚ñº</button>
                                <div id="quartersOfferedList" class="filter-list" style="display: none;">
                                    <label class="filter-checkbox">
                                        <input type="checkbox" value="Fall" id="qo-add-fall"> Fall
                                    </label>
                                    <label class="filter-checkbox">
                                        <input type="checkbox" value="Winter" id="qo-add-winter"> Winter
                                    </label>
                                    <label class="filter-checkbox">
                                        <input type="checkbox" value="Spring" id="qo-add-spring"> Spring
                                    </label>
                                    <label class="filter-checkbox">
                                        <input type="checkbox" value="Summer" id="qo-add-summer"> Summer
                                    </label>
                                </div>
                            </div>
                            <button type="submit">Add Course</button>
                        </form>
                        <div class="program-filter">
                            <label style="font-size: 14px; font-weight: 600; margin-bottom: 5px; display: block;">Filter by Program:</label>
                            <select id="programFilterSelect" onchange="UIState.updateProgramFilter()">
                                <option value="">All Programs</option>
                            </select>
                        </div>
                        <div id="coursesList"></div>
                    </div>
                </section>

                <!-- Classrooms Section -->
                <section class="panel">
                    <h2 class="collapsible-header" onclick="UIState.toggleSection('classrooms')">
                        <span class="collapse-icon" id="classrooms-icon">‚ñº</span> Classrooms
                    </h2>
                    <div id="classrooms-section" class="collapsible-section">
                        <form id="addClassroomForm">
                            <input type="text" id="roomNumber" placeholder="Room number" required>
                            <button type="submit">Add Classroom</button>
                        </form>
                    </div>
                </section>
            </aside>

            <!-- Main Area: Schedule Grid -->
            <main class="schedule-area">
                <h2>Schedule</h2>
                <div class="cohort-summary-controls">
                    <button id="cohortSummaryBtn" onclick="CohortSummary.show()">üìä Cohort Summary</button>
                </div>
                <div id="timeslotManager"></div>
                <div id="validationSummary" class="validation-summary" style="display: none;">
                    <div class="validation-header" onclick="Validation.toggle()">
                        <span class="validation-icon" id="validation-collapse-icon">‚ñº</span>
                        <span class="validation-title">‚ö†Ô∏è Scheduling Conflicts</span>
                        <span class="validation-count" id="validationCount"></span>
                    </div>
                    <div id="validationErrors" class="validation-errors"></div>
                </div>
                <div id="scheduleGrid"></div>
            </main>
        </div>
    </div>

    <!-- Modal for editing course -->
    <div id="courseModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Edit Course</h2>
                <span class="close-modal">&times;</span>
            </div>
            <form id="editCourseForm">
                <div class="form-group">
                    <label for="editCourseProgram">Program</label>
                    <select id="editCourseProgram">
                        <option value="">Select Program</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="editCourseNumber">Course Number</label>
                    <input type="text" id="editCourseNumber" placeholder="e.g. 101">
                </div>
                <div class="form-group">
                    <label for="editCourseName">Course Name</label>
                    <input type="text" id="editCourseName" placeholder="Optional description">
                </div>
                <div class="form-group">
                    <label for="editCourseCredits">Credits</label>
                    <input type="number" id="editCourseCredits" min="1" required>
                </div>
                <div class="form-group">
                    <label for="editCourseQuarterTaken">Cohort</label>
                    <input type="text" id="editCourseQuarterTaken" placeholder="e.g. Q1, Q2">
                </div>
                <div class="form-group">
                    <label>Quarters Offered</label>
                    <div class="quarters-offered-dropdown">
                        <button type="button" class="filter-toggle" onclick="UIState.toggleQuartersOffered(event, 'edit')">Select Quarters ‚ñº</button>
                        <div id="editQuartersOfferedList" class="filter-list" style="display: none;">
                            <label class="filter-checkbox">
                                <input type="checkbox" value="Fall" id="qo-edit-fall"> Fall
                            </label>
                            <label class="filter-checkbox">
                                <input type="checkbox" value="Winter" id="qo-edit-winter"> Winter
                            </label>
                            <label class="filter-checkbox">
                                <input type="checkbox" value="Spring" id="qo-edit-spring"> Spring
                            </label>
                            <label class="filter-checkbox">
                                <input type="checkbox" value="Summer" id="qo-edit-summer"> Summer
                            </label>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="editCourseInstructor">Instructor (this section)</label>
                    <select id="editCourseInstructor">
                        <option value="">Select Instructor (Optional)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="editCourseSection">Section</label>
                    <input type="text" id="editCourseSection" placeholder="e.g. A, B, 01">
                </div>
                <div class="form-group">
                    <label for="editModality">Modality</label>
                    <select id="editModality">
                        <option value="in-person">üè´ In-Person</option>
                        <option value="online">üíª Online</option>
                        <option value="hybrid">üîÑ Hybrid</option>
                    </select>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" onclick="Modals.closeCourse()">Cancel</button>
                    <button type="submit" class="btn-primary">Save Changes</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal for editing instructor -->
    <div id="instructorModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Edit Instructor</h2>
                <span class="close-instructor-modal">&times;</span>
            </div>
            <form id="editInstructorForm">
                <div class="form-group">
                    <label for="editInstructorName">Instructor Name</label>
                    <input type="text" id="editInstructorName" required>
                </div>
                <div class="form-group">
                    <label for="editInstructorColor">Color</label>
                    <input type="color" id="editInstructorColor" value="#3498db">
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" onclick="Modals.closeInstructor()">Cancel</button>
                    <button type="submit" class="btn-primary">Save Changes</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal for selecting modality when dropping course -->
    <div id="modalityModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Schedule Course</h2>
            </div>
            <div class="modality-section-input">
                <label for="modalitySectionInput">Section (optional)</label>
                <input type="text" id="modalitySectionInput" placeholder="e.g. A, B, 01">
            </div>
            <div class="modality-options">
                <button class="modality-btn" onclick="Modals.selectModality('in-person')">
                    <span class="modality-icon">üè´</span>
                    In-Person
                </button>
                <button class="modality-btn" onclick="Modals.selectModality('online')">
                    <span class="modality-icon">üíª</span>
                    Online
                </button>
                <button class="modality-btn" onclick="Modals.selectModality('hybrid')">
                    <span class="modality-icon">üîÑ</span>
                    Hybrid
                </button>
            </div>
        </div>
    </div>

    <!-- Cohort Summary Modal -->
    <div id="cohortSummaryModal" class="modal">
        <div class="modal-content" style="max-width: 900px; max-height: 85vh; overflow-y: auto; padding: 30px;">
            <div class="modal-header">
                <h2>üìä Cohort Schedule Summary</h2>
                <span class="close-cohort-summary-modal" onclick="CohortSummary.close()" style="cursor: pointer; font-size: 28px; color: #888;">&times;</span>
            </div>
            <div id="cohortSummaryContent"></div>
        </div>
    </div>

    <!-- Help Modal -->
    <div id="helpModal" class="modal" onclick="Modals.closeHelpOnOutsideClick(event)">
        <div class="modal-content" style="max-width: 800px; max-height: 85vh; overflow-y: auto; padding: 30px;">
            <h2>How to Use</h2>
            <ol style="line-height: 1.8; margin: 20px 0;">
                <li><strong>Add Programs</strong> - Create programs (e.g. CPW) to organize courses</li>
                <li><strong>Add Instructors</strong> - Enter names in the Instructors panel on the left</li>
                <li><strong>Add Courses</strong> - Add courses to the global catalog with program, number, and credits</li>
                <li><strong>Assign Instructors</strong> - Double-click a course to assign an instructor for the current schedule</li>
                <li><strong>Add Classrooms</strong> - Create rooms with room numbers</li>
                <li><strong>Add Time Slots</strong> - Set up shared schedule times for each day (applies to all rooms)</li>
                <li><strong>Set Quarter</strong> - Choose a quarter (Fall/Winter/Spring/Summer) for each schedule</li>
                <li><strong>Schedule Courses</strong> - Drag courses from the sidebar onto schedule slots, then enter an optional section ID and select modality</li>
                <li><strong>Move Courses</strong> - Drag scheduled courses between timeslots to reorganize</li>
                <li><strong>Sections</strong> - Assign section identifiers (e.g. A, B) when scheduling to track different sections of the same course</li>
                <li><strong>Edit Courses/Instructors</strong> - Double-click any course or instructor to edit details</li>
                <li><strong>Export/Import</strong> - Save your data as JSON or load previous schedules</li>
            </ol>

            <h2>Tips</h2>
            <ul style="line-height: 1.8; margin: 20px 0;">
                <li>Courses are stored in a <strong>global catalog</strong> shared across all schedules</li>
                <li><strong>Instructor assignments</strong> are per-schedule and per-section ‚Äî the same course can have different instructors in different sections and schedules</li>
                <li><strong>Instructors</strong> are stored globally and shared across all schedules, so you only need to add them once</li>
                <li>Set <strong>Quarters Offered</strong> on courses to control which quarters they can be scheduled in</li>
                <li>Courses with no quarters offered are treated as <strong>"on demand"</strong> and available any quarter</li>
                <li>Use the <strong>"Copy to All"</strong> button on Monday to quickly set up the same timeslots for the entire week</li>
                <li>Courses can be <strong>scheduled multiple times</strong> (e.g., a course meeting MWF)</li>
                <li><strong>Double-click</strong> scheduled courses to quickly edit course information and modality</li>
                <li><strong>Drag courses</strong> between timeslots to move them (preserves modality)</li>
                <li>Use the <strong>"Arranged"</strong> column for courses that don't have fixed meeting times</li>
                <li><strong>Filter by Program</strong> in the courses section to focus on specific program courses</li>
                <li>Courses are color-coded: <span style="background: #d4edda; padding: 2px 6px; border-radius: 3px;">green = scheduled</span>, <span style="background: #f8d7da; padding: 2px 6px; border-radius: 3px;">red = unscheduled</span></li>
                <li><strong>Time slots are shared</strong> across all rooms in a schedule ‚Äî add them once and every room uses the same times</li>
                <li><strong>Editable time slots</strong> ‚Äî click any start or end time to change it; schedule data migrates automatically</li>
                <li><strong>Overlapping time slots</strong> are detected and flagged with ‚ö†Ô∏è in the grid and time slot manager</li>
                <li><strong>Arranged courses</strong> do not trigger instructor or cohort conflicts ‚Äî they are scheduled separately</li>
                <li>In-person scheduling conflicts are highlighted with a <span style="background: #ffcccc; padding: 2px 6px; border-radius: 3px;">red background</span></li>
            </ul>

            <h2>Modality Options</h2>
            <p style="line-height: 1.8; margin: 15px 0;">When scheduling a course, choose from:</p>
            <ul style="line-height: 1.8; margin: 20px 0;">
                <li>üè´ <strong>In-Person</strong> - Traditional classroom instruction</li>
                <li>üíª <strong>Online</strong> - Virtual/remote instruction</li>
                <li>üîÑ <strong>Hybrid</strong> - Mix of in-person and online</li>
            </ul>
            <p style="line-height: 1.8; margin: 15px 0; color: #666; font-style: italic;">
                Note: Modality is set per scheduled slot, so the same course can have different modalities at different times.
            </p>
            <div style="text-align: center; margin-top: 30px;">
                <button onclick="Modals.closeHelp()" style="padding: 10px 30px; font-size: 16px;">Close</button>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
